ç¬¬04ç« .stm32å·¥ç¨‹æ„å»ºç¼–è¯‘ä¸‹è½½ğŸƒ
===========================================================

ä»¥å¾€ä½¿ç”¨keilå¼€å‘stm32éœ€è¦è‡ªå·±ä¸€æ­¥ä¸€æ­¥çš„æ–°å»ºä¸€ä¸ªå·¥ç¨‹,ä¹Ÿå¯ä»¥åŸºäºå·²æœ‰çš„å·¥ç¨‹æ¨¡æ¿ä¿®æ”¹.ç°åœ¨ä½¿ç”¨stm32cubmeè¿™ä¸ªè½¯ä»¶å°±å¯ä»¥ç›´æ¥ç”Ÿæˆä¸€ä¸ªå·¥ç¨‹,åŒæ—¶å¯ä»¥è¿›è¡Œå¤–è®¾çš„åˆå§‹åŒ–é…ç½®.æ‰€ä»¥åé¢å°±ä»¥ ``keil+stm323cubemx`` çš„æ–¹å¼å­¦ä¹ . stm323cubemxç”Ÿæˆé¡¹ç›®çš„å·¥ç¨‹ä»¥åŠå¤–è®¾çš„åˆå§‹åŒ–,keilç¼–è¯‘ã€è°ƒè¯•ã€ä¸‹è½½ç¨‹åº.

4.1 stm32cubemxæ–°å»ºstm32å·¥ç¨‹ğŸƒ
-----------------------------------------------------------

1. æ ¹æ®ä½¿ç”¨çš„mcuçš„å‹å·åˆ›å»ºå·¥ç¨‹.

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬1æ­¥.png
   :alt: stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬1æ­¥
   :width: 60%
   :align: center

------

2. é”®å…¥ä½¿ç”¨çš„stm32å•ç‰‡æœºçš„å‹å·.

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬2æ­¥.png
   :alt: stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬2æ­¥
   :width: 60%
   :align: center

------

3. é€‰æ‹©æ—¶é’Ÿæº,è¿™é‡Œé…ç½®äº†é«˜é€Ÿæ—¶é’Ÿæºå’Œä½é€Ÿæ—¶é’Ÿæºä¸¤ç§.

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬3æ­¥.png
   :alt: stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬3æ­¥
   :width: 60%
   :align: center

------

4. é…ç½®ä¸‹è½½å™¨çš„ç§ç±»,ä¸è®ºä½¿ç”¨jlinkè¿˜æ˜¯stlinkä¸‹è½½å™¨ä½¿ç”¨çš„éƒ½æ˜¯swdæ¥å£,æ‰€ä»¥éœ€è¦å…ˆé…ç½®ä¸‹è½½çš„æ–¹å¼,å¦‚æœä¸é…ç½®å¯èƒ½ä¼šå¯¼è‡´ä¸‹ä¸€æ¬¡æ— æ³•ä¸‹è½½çš„é—®é¢˜.

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬4æ­¥.png
   :alt: stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬4æ­¥
   :width: 60%
   :align: center

------

5. è¿™é‡Œéœ€è¦é…ç½®å·¥ç¨‹çš„åç§°ä»¥åŠå·¥ç¨‹çš„è·¯å¾„,stm32cubemxå¯ä»¥ç”Ÿæˆå¤šç§å·¥ç¨‹æ–‡ä»¶,æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯mdk,æ‰€ä»¥é…ç½®ä¸ºmdk.

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬5æ­¥.png
   :alt: stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬5æ­¥
   :width: 60%
   :align: center

------

6. è¿™é‡Œä¹Ÿè¦å‹¾é€‰"Generate peripheral initalization as pair of '.c/h' files per peripheral"

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬6æ­¥.png
   :alt: stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬6æ­¥
   :width: 60%
   :align: center

------

7. ç‚¹å‡»â€œOpen Projectâ€å³å¯æ‰“å¼€MDKçš„å·¥ç¨‹.

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬7æ­¥.png
   :alt: stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬7æ­¥
   :width: 60%
   :align: center

------

4.2 keilç¼–è¯‘stm32å·¥ç¨‹ğŸƒ
-----------------------------------------------------------

1. æ‰“å¼€keilåçš„ä¸»ç•Œé¢.

.. figure:: ./../media/stm32cubemxç¼–è¯‘å·¥ç¨‹ç¬¬1æ­¥.png
   :alt: stm32cubemxç¼–è¯‘å·¥ç¨‹ç¬¬1æ­¥
   :width: 60%
   :align: center

------

2. å¦‚ä¸‹å›¾ç¤º,ç¼–è¯‘æŒ‰é’®.

.. figure:: ./../media/stm32cubemxæ–°å»ºå·¥ç¨‹ç¬¬2æ­¥.png
   :alt: stm32cubemxç¼–è¯‘å·¥ç¨‹ç¬¬2æ­¥
   :width: 60%
   :align: center

------


4.3 ä¸‹è½½ç¨‹åºåˆ°å¼€å‘æ¿ğŸƒ
-----------------------------------------------------------

stm32çš„ä¸‹è½½æŒ‰ç…§æ¥å£åˆ†æœ‰:swdä¸‹è½½ã€ä¸²å£ispä¸‹è½½ã€jtagä¸‹è½½.è¿™ä¸‰ç§ä¸‹è½½æ–¹å¼å¯¹åº”ä¸åŒçš„æ¥çº¿æ–¹å¼,jtagæ¥å£ä¸‹è½½ç”±äºéœ€è¦è¿æ¥è¾ƒå¤šçš„çº¿,æ‰€ä»¥æ•™ç¨‹ä¸­ä¸æ¶‰åŠåˆ°.æœ€æ–¹ä¾¿çš„ä¸‹è½½æ–¹å¼æ˜¯swdæ¥å£ä¸‹è½½,åªéœ€è¦ä¸¤æ ¹ä¸‹è½½çº¿å³å¯,è€Œä¸”é€Ÿåº¦å¾ˆå¿«,ä¸²å£ä¸‹è½½éœ€è¦é€‰æ‹©bootæ¨¡å¼è€Œä¸”é€Ÿåº¦æ…¢,åªæœ‰åœ¨æ²¡æœ‰ä¸‹è½½å™¨çš„æ—¶å€™æ‰ä¼šä½¿ç”¨ä¸²å£ispä¸‹è½½.


4.3.1 é€šè¿‡ä¸‹è½½å™¨ä¸‹è½½ç¨‹åºåˆ°å¼€å‘æ¿ğŸƒ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. é€‰æ‹©ä½¿ç”¨çš„ä¸‹è½½å™¨ç±»å‹.

.. figure:: ./../media/stm32cubemxä¸‹è½½å›ºä»¶ç¬¬1æ­¥.png
   :alt: stm32cubemxä¸‹è½½å›ºä»¶ç¬¬1æ­¥
   :width: 60%
   :align: center

------

2. ä¸‹è½½å™¨çš„Port,é€‰æ‹© "SW"

.. figure:: ./../media/stm32cubemxä¸‹è½½å›ºä»¶ç¬¬2æ­¥.png
   :alt: stm32cubemxä¸‹è½½å›ºä»¶ç¬¬2æ­¥
   :width: 60%
   :align: center

------

3. å‹¾é€‰â€œReset and Runâ€

.. figure:: ./../media/stm32cubemxä¸‹è½½å›ºä»¶ç¬¬3æ­¥.png
   :alt: stm32cubemxä¸‹è½½å›ºä»¶ç¬¬3æ­¥
   :width: 60%
   :align: center

------

4. ç‚¹å‡»â€œLOADâ€,ä¸‹è½½ç¨‹åº

.. figure:: ./../media/stm32cubemxä¸‹è½½å›ºä»¶ç¬¬4æ­¥.png
   :alt: stm32cubemxä¸‹è½½å›ºä»¶ç¬¬4æ­¥
   :width: 60%
   :align: center

------

5. ä¸‹è½½å®Œæˆæ—¥å¿—.

.. figure:: ./../media/stm32cubemxä¸‹è½½å›ºä»¶ç¬¬5æ­¥.png
   :alt: stm32cubemxä¸‹è½½å›ºä»¶ç¬¬5æ­¥
   :width: 60%
   :align: center


4.3.2 é€šè¿‡ä¸²å£çº¿ä¸‹è½½ç¨‹åºåˆ°å•ç‰‡æœºğŸƒ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

å¦‚ä¸‹å›¾,ä½¿ç”¨flymcuè½¯ä»¶å°†å›ºä»¶ä¸‹è½½åˆ°å•ç‰‡æœº,ç«¯å£å·é€‰æ‹©ch340çš„ç«¯å£.æ³¢ç‰¹ç‡é»˜è®¤é€‰æ‹©115200.å·¦ä¸‹é”®å…³äºRTSå’ŒDTRçš„é€‰æ‹©é»˜è®¤å³å¯,å®æµ‹é€‰æ‹©ä»»æ„ä¸€ä¸ªéƒ½èƒ½ä¸‹è½½è¿›å».å…¶ä»–é…ç½®å¦‚å›¾å³å¯.

.. figure:: ./../media/flymcuä¸‹è½½ç•Œé¢.png
   :alt: ä¸²å£ispä¸‹è½½ flymcuç•Œé¢
   :width: 60%
   :align: center

------

æ£€æŸ¥keilä¸­æ˜¯å¦å‹¾é€‰ç”Ÿæˆhexæ–‡ä»¶,å¦‚æœæ²¡æœ‰å‹¾é€‰åˆ™éœ€è¦åœ¨å‹¾é€‰åå†æ¬¡ç¼–è¯‘ä»£ç ,ç”Ÿæˆçš„hexæ–‡ä»¶ä½äºtogetek\MDK-ARM\togetekæ–‡ä»¶å¤¹ä¸‹.å¯¼å…¥åˆ°flymcu.

.. figure:: ./../media/keilç”Ÿæˆhexæ–‡ä»¶.png
   :alt: keilç”Ÿæˆhexæ–‡ä»¶
   :width: 60%
   :align: center

------

.. figure:: ./../media/bootæ¨¡å¼é€‰æ‹©.png
   :alt: keilç”Ÿæˆhexæ–‡ä»¶
   :width: 60%
   :align: center

------

4.3.3 stm32å‡ ç§ä¸‹è½½æ–¹å¼çš„å¯¹æ¯”ğŸƒ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. csv-table:: stm32å‡ ç§ä¸‹è½½æ–¹å¼çš„å¯¹æ¯”
  :align: center
  :header: å¯¹æ¯”,swdæ¥å£,ä¸²å£ispæ¥å£,jtagæ¥å£
  :widths: 30,30,30,30

  æ¥çº¿,swclkå’Œswdio,rxå’Œtx,å¤šæ ¹ä¸‹è½½çº¿
  é€Ÿåº¦,å¿«,æ…¢,å¿«
  æ”¯æŒä»¿çœŸ,æ”¯æŒ,ä¸æ”¯æŒ,æ”¯æŒ
  è®¾å¤‡,dap-linkã€j-linkã€st-link,ä¸²å£çº¿,j-link




